## Домашняя работа 3 

Требуется написать приложение, которое будет выполнять следующее:
1. Вычитывать из CSV-файла, который можно скачать по ссылке - https://www.kaggle.com/sootersaalu/amazon-top-50-bestselling-books-2009-2019, данные, сериализовывать их в JSON, и записывать в топик books локльно развернутого сервиса Apache Kafka.
2. Вычитать из топика books данные и распечатать в stdout последние 5 записей (c максимальным значением offset) из каждой партиции. При чтении топика одновременно можно хранить в памяти только 15 записей.
### Сборка и запуск приложения:
Предварительно установить scala 2.12, sbt 1.4.4, java1.8
1) Перед началом выполнения требуется развернуть Kafka через docker-compose (https://github.com/Gorini4/kafka_scala_example) и создать топик books с 3 партициями.
```
docker-compose up -d
```
```
docker exec hw3_kafka_broker_1 kafka-topics \
  --create \
  --zookeeper zookeeper:2181 \
  --replication-factor 1 \
  --partitions 3 \
  --topic books
```
2) Собрать executable jar в папке с проектом `sbt assembly`
3) После окончания сборки будет указан путь, где расположен файл 
```
[info] Packaging target/hw3_kafka-assembly-{VERSION}.jar
```
3) Запуск джобы осуществляется через scala интерпретатор

Пример запуска:
```
$ scala hw3_kafka-assembly-0.1.jar
partition=2, lastOffset=2855
partition=0, lastOffset=2533
partition=1, lastOffset=1809
ConsumerRecord(topic = books, partition = 0, leaderEpoch = 0, offset = 2533, CreateTime = 1614554357727, serialized key size = 205, serialized value size = 205, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"You Are a Badass: How to Stop Doubting Your Greatness and Start Living an Awesome Life","author":"Jen Sincero","userRating":"4.7","reviews":"14331","price":"8","year":"2019","genre":"Non Fiction"}, value = {"name":"You Are a Badass: How to Stop Doubting Your Greatness and Start Living an Awesome Life","author":"Jen Sincero","userRating":"4.7","reviews":"14331","price":"8","year":"2019","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 0, leaderEpoch = 0, offset = 2532, CreateTime = 1614554357727, serialized key size = 205, serialized value size = 205, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"You Are a Badass: How to Stop Doubting Your Greatness and Start Living an Awesome Life","author":"Jen Sincero","userRating":"4.7","reviews":"14331","price":"8","year":"2017","genre":"Non Fiction"}, value = {"name":"You Are a Badass: How to Stop Doubting Your Greatness and Start Living an Awesome Life","author":"Jen Sincero","userRating":"4.7","reviews":"14331","price":"8","year":"2017","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 0, leaderEpoch = 0, offset = 2531, CreateTime = 1614554357726, serialized key size = 123, serialized value size = 123, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2016","genre":"Fiction"}, value = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2016","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 0, leaderEpoch = 0, offset = 2530, CreateTime = 1614554357724, serialized key size = 168, serialized value size = 168, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Winter of the World: Book Two of the Century Trilogy","author":"Ken Follett","userRating":"4.5","reviews":"10760","price":"15","year":"2012","genre":"Fiction"}, value = {"name":"Winter of the World: Book Two of the Century Trilogy","author":"Ken Follett","userRating":"4.5","reviews":"10760","price":"15","year":"2012","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 0, leaderEpoch = 0, offset = 2529, CreateTime = 1614554357723, serialized key size = 174, serialized value size = 174, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Wild: From Lost to Found on the Pacific Crest Trail","author":"Cheryl Strayed","userRating":"4.4","reviews":"17044","price":"18","year":"2012","genre":"Non Fiction"}, value = {"name":"Wild: From Lost to Found on the Pacific Crest Trail","author":"Cheryl Strayed","userRating":"4.4","reviews":"17044","price":"18","year":"2012","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 2, leaderEpoch = 0, offset = 2855, CreateTime = 1614554357726, serialized key size = 205, serialized value size = 205, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"You Are a Badass: How to Stop Doubting Your Greatness and Start Living an Awesome Life","author":"Jen Sincero","userRating":"4.7","reviews":"14331","price":"8","year":"2016","genre":"Non Fiction"}, value = {"name":"You Are a Badass: How to Stop Doubting Your Greatness and Start Living an Awesome Life","author":"Jen Sincero","userRating":"4.7","reviews":"14331","price":"8","year":"2016","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 2, leaderEpoch = 0, offset = 2854, CreateTime = 1614554357726, serialized key size = 158, serialized value size = 158, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Wrecking Ball (Diary of a Wimpy Kid Book 14)","author":"Jeff Kinney","userRating":"4.9","reviews":"9413","price":"8","year":"2019","genre":"Fiction"}, value = {"name":"Wrecking Ball (Diary of a Wimpy Kid Book 14)","author":"Jeff Kinney","userRating":"4.9","reviews":"9413","price":"8","year":"2019","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 2, leaderEpoch = 0, offset = 2853, CreateTime = 1614554357726, serialized key size = 123, serialized value size = 123, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2017","genre":"Fiction"}, value = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2017","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 2, leaderEpoch = 0, offset = 2852, CreateTime = 1614554357724, serialized key size = 123, serialized value size = 123, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2015","genre":"Fiction"}, value = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2015","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 2, leaderEpoch = 0, offset = 2851, CreateTime = 1614554357724, serialized key size = 123, serialized value size = 123, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2013","genre":"Fiction"}, value = {"name":"Wonder","author":"R. J. Palacio","userRating":"4.8","reviews":"21625","price":"9","year":"2013","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 1, leaderEpoch = 0, offset = 1809, CreateTime = 1614553964237, serialized key size = 156, serialized value size = 156, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"What to Expect When You're Expecting","author":"Heidi Murkoff","userRating":"4.4","reviews":"3341","price":"9","year":"2011","genre":"Non Fiction"}, value = {"name":"What to Expect When You're Expecting","author":"Heidi Murkoff","userRating":"4.4","reviews":"3341","price":"9","year":"2011","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 1, leaderEpoch = 0, offset = 1808, CreateTime = 1614553964236, serialized key size = 200, serialized value size = 200, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"\"Unbroken: A World War II Story of Survival, Resilience, and Redemption\"","author":"Laura Hillenbrand","userRating":"4.8","reviews":"29673","price":"13","year":"2014","genre":"Non Fiction"}, value = {"name":"\"Unbroken: A World War II Story of Survival, Resilience, and Redemption\"","author":"Laura Hillenbrand","userRating":"4.8","reviews":"29673","price":"13","year":"2014","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 1, leaderEpoch = 0, offset = 1807, CreateTime = 1614553964236, serialized key size = 200, serialized value size = 200, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"\"Unbroken: A World War II Story of Survival, Resilience, and Redemption\"","author":"Laura Hillenbrand","userRating":"4.8","reviews":"29673","price":"16","year":"2012","genre":"Non Fiction"}, value = {"name":"\"Unbroken: A World War II Story of Survival, Resilience, and Redemption\"","author":"Laura Hillenbrand","userRating":"4.8","reviews":"29673","price":"16","year":"2012","genre":"Non Fiction"})
ConsumerRecord(topic = books, partition = 1, leaderEpoch = 0, offset = 1806, CreateTime = 1614553964235, serialized key size = 177, serialized value size = 177, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"Ultimate Sticker Book: Frozen: More Than 60 Reusable Full-Color Stickers","author":"DK","userRating":"4.5","reviews":"2586","price":"5","year":"2014","genre":"Fiction"}, value = {"name":"Ultimate Sticker Book: Frozen: More Than 60 Reusable Full-Color Stickers","author":"DK","userRating":"4.5","reviews":"2586","price":"5","year":"2014","genre":"Fiction"})
ConsumerRecord(topic = books, partition = 1, leaderEpoch = 0, offset = 1805, CreateTime = 1614553964235, serialized key size = 159, serialized value size = 159, headers = RecordHeaders(headers = [], isReadOnly = false), key = {"name":"\"Twilight (The Twilight Saga, Book 1)\"","author":"Stephenie Meyer","userRating":"4.7","reviews":"11676","price":"9","year":"2009","genre":"Fiction"}, value = {"name":"\"Twilight (The Twilight Saga, Book 1)\"","author":"Stephenie Meyer","userRating":"4.7","reviews":"11676","price":"9","year":"2009","genre":"Fiction"})
```
